zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 7df96b18c230490a9a0a9e2307226338
      name: Templates
  templates:
    - uuid: 1d94437d4e37499bb2c5abf47fde6c00
      template: 'Home Assistant - Zabbix'
      name: 'Home Assistant - Zabbix'
      description: |
        Home Assistant-Template, erstellt von Thomas Rzen.
        
        To ensure this template operates correctly, the URL and the API key should be stored in the Macros section.
        
        If you need help, visit https://github.com/Garfieldttt/zabbix-homeassistant
      groups:
        - name: Templates
      items:
        - uuid: 2c4ed5c0c5be4840ac89801834efae58
          name: HA-raw
          type: HTTP_AGENT
          key: ha.raw
          value_type: TEXT
          trends: '0'
          url: '{$HA.URL}/api/states'
          headers:
            - name: Authorization
              value: 'Bearer {$API.TOKEN}'
          output_format: JSON
      discovery_rules:
        - uuid: d6a30debaed74aa09515805c866d8b87
          name: HA-Automation
          type: DEPENDENT
          key: ha.automation
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '^automation\..*'
                formulaid: A
          item_prototypes:
            - uuid: 7e37c15d52c346ed8aaf351a882e36a9
              name: 'automation {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ha.autot[{#ENTITY_ID}]'
              delay: '0'
              trends: 730d
              valuemap:
                name: automation
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
                - type: STR_REPLACE
                  parameters:
                    - 'on'
                    - '1'
                - type: STR_REPLACE
                  parameters:
                    - 'off'
                    - '0'
                - type: STR_REPLACE
                  parameters:
                    - unavailable
                    - '2'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: automations
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: 041bbefc72cb4ffea38a2012e0b79cf2
          name: HA-Batterie
          type: DEPENDENT
          key: ha.batt
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*_battery$'
                formulaid: A
          item_prototypes:
            - uuid: 175a65ef0f384596a0bc5177ea1b0458
              name: 'Battery level of {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ent.bat[{#ENTITY_ID}]'
              delay: '0'
              value_type: FLOAT
              trends: 730d
              units: '!%'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: battery-level
              trigger_prototypes:
                - uuid: daaafb9fae15422e9df4375d90a3fb36
                  expression: 'last(/Home Assistant - Zabbix/ent.bat[{#ENTITY_ID}])<{$BATTERY.MINIMUM:"{#ENTITY_ID}"} and {$SWITCH.TRIGGER.BATTERY:"{#ENTITY_ID}"} = 1'
                  name: 'Battery replacement at {#ENTITY_ID} is required.'
                  priority: HIGH
          graph_prototypes:
            - uuid: a899f3a994c842dea0f26842b525b6c0
              name: 'Battery level'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                - color: FFBF00
                  calc_fnc: ALL
                  item:
                    host: 'Home Assistant - Zabbix'
                    key: 'ent.bat[{#ENTITY_ID}]'
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: b21d364cbc23433ca3876572fb74b8bb
          name: HA-Camera
          type: DEPENDENT
          key: ha.camera
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '^camera\..*'
                formulaid: A
          item_prototypes:
            - uuid: a69e97081d10499ba67335c3cbd2a1e4
              name: 'Camera status {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ha.cam.stat[{#ENTITY_ID}]'
              delay: '0'
              trends: 730d
              valuemap:
                name: camera
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
                - type: STR_REPLACE
                  parameters:
                    - unavailable
                    - '0'
                - type: STR_REPLACE
                  parameters:
                    - available
                    - '1'
                - type: STR_REPLACE
                  parameters:
                    - idle
                    - '2'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: camera
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: 1311148760784d948dc433324f030bc9
          name: HA-Contact-Sensor
          type: DEPENDENT
          key: ha.contact
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*_ajto$'
                formulaid: A
              - macro: '{#ENTITY_ID}'
                value: '.*_contact$'
                formulaid: B
              - macro: '{#ENTITY_ID}'
                value: '.*_door$'
                formulaid: C
          item_prototypes:
            - uuid: c7d6d4e1266d4310ac88aec260d7e490
              name: 'Open/Close Sensor {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ent.conbtact[{#ENTITY_ID}]'
              delay: '0'
              trends: 730d
              valuemap:
                name: contact-sensot
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
                - type: STR_REPLACE
                  parameters:
                    - 'off'
                    - '0'
                - type: STR_REPLACE
                  parameters:
                    - 'on'
                    - '1'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: contact-sensor-status
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: ca8b557897294617a9335951eb401671
          name: HA-fine-dust
          type: DEPENDENT
          key: ha.fine.dust
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*_pm25$'
                formulaid: A
          item_prototypes:
            - uuid: 32084b6e9438468eb986038eebbf657c
              name: 'Find dust {#ENTITY_ID}'
              type: DEPENDENT
              key: 'fine.dust[{#ENTITY_ID}]'
              delay: '0'
              trends: 730d
              units: '!PM2.5'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: fine-dust
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: 1f4986b135ca49d3a47930d0e43c7eac
          name: HA-Weather-forecast
          type: DEPENDENT
          key: ha.forecast
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*forecast_home$'
                formulaid: A
          item_prototypes:
            - uuid: df0e32186224466481e2ebe7f8e9bab4
              name: 'Weather forecast {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ha.forecast[{#ENTITY_ID}]'
              delay: '0'
              trends: 730d
              description: |
                1=Clear, night: The sky is clear during the night.
                2=Cloudy: There are many clouds in the sky.
                3=Fog: There is a thick mist or fog reducing visibility.
                4=Hail: Hailstones are falling.
                5=Lightning: Lightning/thunderstorms are occurring.
                6=Lightning, rainy: Lightning/thunderstorm is occurring along with rain.
                7=Partly cloudy: The sky is partially covered with clouds.
                8=Pouring: It is raining heavily.
                9=Rainy: It is raining.
                10=Snowy: It is snowing.
                11=Snowy, rainy: It is snowing and raining at the same time.
                12=Sunny: The sky is clear and the sun is shining.
                13=Windy: It is windy.
                14=Windy, cloudy: It is windy and cloudy.
                15=Exceptional: Exceptional weather conditions are occurring.
              valuemap:
                name: weather
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
                - type: STR_REPLACE
                  parameters:
                    - clear-night
                    - '1'
                - type: STR_REPLACE
                  parameters:
                    - cloudy
                    - '2'
                - type: STR_REPLACE
                  parameters:
                    - fog
                    - '3'
                - type: STR_REPLACE
                  parameters:
                    - hail
                    - '4'
                - type: STR_REPLACE
                  parameters:
                    - lightning
                    - '5'
                - type: STR_REPLACE
                  parameters:
                    - lightning-rainy
                    - '6'
                - type: STR_REPLACE
                  parameters:
                    - partlycloudy
                    - '7'
                - type: STR_REPLACE
                  parameters:
                    - pouring
                    - '8'
                - type: STR_REPLACE
                  parameters:
                    - rainy
                    - '9'
                - type: STR_REPLACE
                  parameters:
                    - snowy
                    - '10'
                - type: STR_REPLACE
                  parameters:
                    - snowy-rainy
                    - '11'
                - type: STR_REPLACE
                  parameters:
                    - sunny
                    - '12'
                - type: STR_REPLACE
                  parameters:
                    - windy
                    - '13'
                - type: STR_REPLACE
                  parameters:
                    - windy-variant
                    - '14'
                - type: STR_REPLACE
                  parameters:
                    - exceptional
                    - '15'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: weather-forecast
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: 9a7d25208cff4c65929f670e291a4bdc
          name: HA-Illuminance
          type: DEPENDENT
          key: ha.illu
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*_illuminance$'
                formulaid: A
          item_prototypes:
            - uuid: 910c678e05454c7bb80c3e1f72d33d3a
              name: 'Illuminance {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ent.illu[{#ENTITY_ID}]'
              delay: '0'
              value_type: FLOAT
              trends: 730d
              units: '!lux'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: illuminance
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: 2459164c5d1d4a0ca13f527612377f35
          name: HA-Zigbee-linkquality
          type: DEPENDENT
          key: ha.linkquality
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*_linkquality$'
                formulaid: A
          item_prototypes:
            - uuid: adb345f9bd2942a2a2ca378028c15eb5
              name: 'ZigBee-Linkquality {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ent.linkquality[{#ENTITY_ID}]'
              delay: '0'
              value_type: FLOAT
              trends: 730d
              units: '!LQI'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: zigbee-linkquality
              trigger_prototypes:
                - uuid: bcd8ff30b0ec4ac2806732d3a9209c06
                  expression: 'min(/Home Assistant - Zabbix/ent.linkquality[{#ENTITY_ID}],5m)<{$SWITCH.TRIGGER.ZIGBEE:"{#ENTITY_ID}"} or last(/Home Assistant - Zabbix/ent.linkquality[{#ENTITY_ID}]) < {$ZIGBEE.SIGNAL.MINIMUM:"{#ENTITY_ID}"} and {$SWITCH.TRIGGER.ZIGBEE:"{#ENTITY_ID}"} = 1'
                  name: 'The ZigBee connection of {#ENTITY_ID}: {ITEM.LASTVALUE}'
                  priority: HIGH
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: 9b9c150e83af417599542bd13274a9f6
          name: HA-Humidity
          type: DEPENDENT
          key: ha.luft
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*_humidity$'
                formulaid: A
          item_prototypes:
            - uuid: d5b546cae3cb4664b5b2675002ad5111
              name: 'Humidity of {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ent.luft[{#ENTITY_ID}]'
              delay: '0'
              value_type: FLOAT
              trends: 730d
              units: '!%'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: humidity
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: 47c91bbb9cc04aaf9f952bdbd6af2c12
          name: HA-Occupancy
          type: DEPENDENT
          key: ha.occupancy
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*_occupancy$'
                formulaid: A
          item_prototypes:
            - uuid: 80af63d9c9514085a1eaef59042a95b6
              name: 'Occupancy of {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ha.occupancy[{#ENTITY_ID}]'
              delay: '0'
              value_type: FLOAT
              trends: 730d
              valuemap:
                name: occupancy
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
                - type: STR_REPLACE
                  parameters:
                    - 'on'
                    - '1'
                - type: STR_REPLACE
                  parameters:
                    - 'off'
                    - '0'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: occupancy
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: 521c20cefdc24936b1086368fe0a9ff0
          name: HA-atmospheric-pressure
          type: DEPENDENT
          key: ha.pressure
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*_pressure$'
                formulaid: A
          item_prototypes:
            - uuid: dcc27475843a4422be16739172c0f982
              name: 'Atmospheric pressure of {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ent.pressure[{#ENTITY_ID}]'
              delay: '0'
              value_type: FLOAT
              trends: 730d
              units: '!hPa'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: atmospheric-pressure
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: 53a32b87ee124a02a6893561d31b23da
          name: HA-Temperature
          type: DEPENDENT
          key: ha.temp
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*temperature$'
                formulaid: A
          item_prototypes:
            - uuid: 3cb17f2dc8394b51b57ace27f0547c26
              name: 'Temperatur {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ent.i.d[{#ENTITY_ID}]'
              delay: '0'
              value_type: FLOAT
              trends: 730d
              units: '!°C'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: RTRIM
                  parameters:
                    - '"]'
                - type: LTRIM
                  parameters:
                    - '["'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: degrees-celsius
              trigger_prototypes:
                - uuid: 6f7502c07a654f1c943520fbd24c81dc
                  expression: 'last(/Home Assistant - Zabbix/ent.i.d[{#ENTITY_ID}]) > {$TRIGGER.TEMPERATURE:"{#ENTITY_ID}"} and {$SWITCH.TRIGGER.TEMPERATURE:"{#ENTITY_ID}"} = 1'
                  name: 'The temperature of {#ENTITY_ID} has exceeded {$TRIGGER.TEMPERATURE}.'
                  priority: AVERAGE
                  manual_close: 'YES'
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: 8922c14e83f04a738cddab0e484dfd49
          name: HA-Update
          type: DEPENDENT
          key: ha.update
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*_update$'
                formulaid: A
          item_prototypes:
            - uuid: f721473c84cd46eeb204fa5e2c304e8b
              name: 'Update available for {#ENTITY_ID}.'
              type: DEPENDENT
              key: 'ha.update[{#ENTITY_ID}]'
              delay: '0'
              trends: 730d
              valuemap:
                name: update
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
                - type: STR_REPLACE
                  parameters:
                    - 'on'
                    - '1'
                - type: STR_REPLACE
                  parameters:
                    - 'off'
                    - '0'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: update
              trigger_prototypes:
                - uuid: 9bd597210e2a4b4b9e35ada4ab0b36fa
                  expression: 'last(/Home Assistant - Zabbix/ha.update[{#ENTITY_ID}])=1 and {$SWITCH.TRIGGER.HA_UPDATE:"{#ENTITY_ID}"} = 1 and {$SWITCH.TRIGGER.HA_UPDATE:"{#ENTITY_ID}"}'
                  name: 'Home Assistant update for {#ENTITY_ID} is available.'
                  priority: HIGH
                  manual_close: 'YES'
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: 72328c6a1ac745ffbd3e11758cfac97d
          name: HA-Firmware-Update
          type: DEPENDENT
          key: ha.update.firmware
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*_firmware$'
                formulaid: A
          item_prototypes:
            - uuid: c03379cfab1046a5bbaea1bef589a383
              name: 'Firmware-update {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ent.firmware[{#ENTITY_ID}]'
              delay: '0'
              trends: 730d
              valuemap:
                name: firmware-update
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
                - type: STR_REPLACE
                  parameters:
                    - 'off'
                    - '0'
                - type: STR_REPLACE
                  parameters:
                    - 'on'
                    - '1'
                - type: STR_REPLACE
                  parameters:
                    - unavailable
                    - '2'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: firmware-update
              trigger_prototypes:
                - uuid: 2cec62c566f04555b8ccac1a128d1a1a
                  expression: 'last(/Home Assistant - Zabbix/ent.firmware[{#ENTITY_ID}])=1 and {$SWITCH.TRIGGER.FIRMWARE} = 1'
                  name: 'Firmware update for {#ENTITY_ID} is available.'
                  priority: WARNING
                - uuid: b84255b67cc1466e8deff251c49d2f17
                  expression: 'last(/Home Assistant - Zabbix/ent.firmware[{#ENTITY_ID}])=2 and {$SWITCH.TRIGGER.FIRMWARE} = 1'
                  name: 'Firmware version for {#ENTITY_ID} is not available'
                  priority: WARNING
                  manual_close: 'YES'
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: a0b0fff3bc1d4c269cec7f463497c718
          name: HA-VOC
          type: DEPENDENT
          key: ha.voc
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*voc_index$'
                formulaid: A
          item_prototypes:
            - uuid: 0fbd1d0659a349bb8a5fedfeeb4c403a
              name: 'Pollutants indoor air {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ent.pollutants[{#ENTITY_ID}]'
              delay: '0'
              value_type: FLOAT
              trends: 730d
              units: '!VOC'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: pollutants-indoor-air
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: b20727113c364d5ba4a098b050fd5663
          name: HA-Watt
          type: DEPENDENT
          key: ha.watt
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '.*_power$'
                formulaid: A
          item_prototypes:
            - uuid: ccd1924ee7e6456fab25344d2245430c
              name: 'Watt {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ent.watt[{#ENTITY_ID}]'
              delay: '0'
              value_type: FLOAT
              trends: 730d
              units: '!Watt'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].state'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
                - type: STR_REPLACE
                  parameters:
                    - unavailable
                    - '0'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: Watt
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
        - uuid: 89976aef185a473a8fea54c3adce8aaf
          name: HA-Zone
          type: DEPENDENT
          key: ha.zone
          delay: '0'
          filter:
            conditions:
              - macro: '{#ENTITY_ID}'
                value: '^zone\..*'
                formulaid: A
          item_prototypes:
            - uuid: 2364f352a9a74a8cae6e1c6a605c1d69
              name: 'Latitude of {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ha.zone.latitude[{#ENTITY_ID}]'
              delay: '0'
              value_type: FLOAT
              trends: 730d
              units: '!LAT'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].attributes.latitude'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: zone-latitude
            - uuid: 6e813687a7884d4287bccaf85a91e1f3
              name: 'Latitude of {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ha.zone.longitude[{#ENTITY_ID}]'
              delay: '0'
              value_type: FLOAT
              trends: 730d
              units: '!LON'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].attributes.longitude'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: zone-longitude
            - uuid: ef844c8505b94a8392d74b474e7622a4
              name: 'Zone radius {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ha.zone.radius[{#ENTITY_ID}]'
              delay: '0'
              value_type: FLOAT
              trends: 730d
              units: '!m'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].attributes.radius'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: zone-radius
            - uuid: fa03ef82db2a4820a87672d748be4c5f
              name: 'Person zone assignment {#ENTITY_ID}'
              type: DEPENDENT
              key: 'ha.zone.zone-assignment[{#ENTITY_ID}]'
              delay: '0'
              history: 730d
              value_type: TEXT
              trends: '0'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.body[?(@.entity_id == "{#ENTITY_ID}")].attributes.persons'
                - type: LTRIM
                  parameters:
                    - '["'
                - type: RTRIM
                  parameters:
                    - '"]'
                - type: LTRIM
                  parameters:
                    - ' person.'
                - type: STR_REPLACE
                  parameters:
                    - '"'
                    - ' '
                - type: STR_REPLACE
                  parameters:
                    - ' person.'
                    - ' '
              master_item:
                key: ha.raw
              tags:
                - tag: 'Home Assistant'
                  value: zone-assignment
          master_item:
            key: ha.raw
          lld_macro_paths:
            - lld_macro: '{#ENTITY_ID}'
              path: $.entity_id
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.body[*]'
      macros:
        - macro: '{$API.TOKEN}'
          type: SECRET_TEXT
        - macro: '{$BATTERY.MINIMUM}'
          value: '30'
          description: 'The trigger activates when the battery drops below 30%.'
        - macro: '{$HA.URL}'
          value: 'http://192.168.10.121:8123'
          description: 'The trigger activates when the Zigbee signal drops below 90 LQI.'
        - macro: '{$SWITCH.TRIGGER.BATTERY}'
          value: '1'
          description: '1 = enable 0 = disable'
        - macro: '{$SWITCH.TRIGGER.FIRMWARE}'
          value: '1'
          description: '1 = enable 0 = disable'
        - macro: '{$SWITCH.TRIGGER.HA_UPDATE}'
          value: '1'
          description: '1 = enable 0 = disable'
        - macro: '{$SWITCH.TRIGGER.TEMPERATURE}'
          value: '0'
          description: '1 = enable 0 = disable'
        - macro: '{$SWITCH.TRIGGER.ZIGBEE}'
          value: '1'
          description: '1 = enable 0 = disable'
        - macro: '{$TRIGGER.TEMPERATURE}'
          value: '44'
          description: 'The trigger activates when the temperature rises above 44 degrees Celsius, meaning it reaches 45°C.'
        - macro: '{$ZIGBEE.SIGNAL.MINIMUM}'
          value: '90'
      valuemaps:
        - uuid: fc783e73a76149cb9a5cfc5e056b20d9
          name: automation
          mappings:
            - value: '1'
              newvalue: enabled
            - value: '0'
              newvalue: disabled
            - value: '2'
              newvalue: unavailable
        - uuid: c310d795d0974bdbb5f5f4e90d84785c
          name: camera
          mappings:
            - value: '0'
              newvalue: unavailable
            - value: '1'
              newvalue: available
            - value: '2'
              newvalue: idle
        - uuid: 899dfe59db4d44e3b192354dbbdc8855
          name: contact-sensot
          mappings:
            - value: '0'
              newvalue: closed
            - value: '1'
              newvalue: open
        - uuid: 0fdd47edf8524752bb012d303c4b3cb2
          name: firmware-update
          mappings:
            - value: '0'
              newvalue: 'no update available'
            - value: '1'
              newvalue: 'an update is available'
            - value: '2'
              newvalue: 'firmware version unavailable'
        - uuid: 390fdda09d75489781371f2e56aff43f
          name: occupancy
          mappings:
            - value: '1'
              newvalue: 'on'
            - value: '0'
              newvalue: 'off'
        - uuid: 5435403b67724914b2991f54d0d29bb8
          name: update
          mappings:
            - value: '0'
              newvalue: 'no update available'
            - value: '1'
              newvalue: 'an update is available'
        - uuid: f3273d81438646ed8ac25ecf2e609854
          name: weather
          mappings:
            - value: '1'
              newvalue: clear-night
            - value: '2'
              newvalue: cloudy
            - value: '3'
              newvalue: fog
            - value: '4'
              newvalue: hail
            - value: '5'
              newvalue: lightning
            - value: '6'
              newvalue: lightning-rainy
            - value: '7'
              newvalue: partlycloudy
            - value: '8'
              newvalue: pouring
            - value: '9'
              newvalue: rainy
            - value: '10'
              newvalue: snowy
            - value: '11'
              newvalue: snowy-rainy
            - value: '12'
              newvalue: sunny
            - value: '13'
              newvalue: windy
            - value: '14'
              newvalue: windy-variant
            - value: '15'
              newvalue: exception
